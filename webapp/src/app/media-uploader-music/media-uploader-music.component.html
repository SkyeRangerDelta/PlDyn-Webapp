<div class="media-uploader-music">
  <div class="add-content-btns">
    <div class="add-content-cols">
      <label for="file-uploader" class="custom-uploader">
        @if (isLoading) {
          <span class="loading-icon"></span>
        }
        @if (!isLoading) {
          <span>
            Add Songs
          </span>
        }
      </label>
      <input id="file-uploader" type="file" (change)="onFileSelect($event)" accept=".mp3, .wav, .flac" multiple />
      @if (uploadErrorMessage) {
        <span class="uploadError-message">{{ uploadErrorMessage }}</span>
      }
    </div>

    <div class="add-content-cols">
      <button id="submit-btn" class="upload-btn" (click)="onSubmit()" [disabled]="!isFormValid()">Upload</button>
    </div>
  </div>
  <table>
    <thead>
      <tr>
        <th>Clear</th>
        <th>Title</th>
        <th>Artist</th>
        <th>Album</th>
        <th>Genre</th>
        <th>Year</th>
        <th>Track</th>
        <th>Album Artist</th>
        <th>Composer</th>
        <th>Disc #</th>
        <th>Cover</th>
      </tr>
    </thead>
    <tbody>
      @for (song of songs; track song) {
        <tr>
          <td><button (click)="removeSong(song)">X</button></td>
          <td><input [(ngModel)]="song.title" required /></td>
          <td><input [(ngModel)]="song.artist" required /></td>
          <td><input [(ngModel)]="song.album" required /></td>
          <td><input [(ngModel)]="song.genre" required /></td>
          <td><input [(ngModel)]="song.year" type="number" required /></td>
          <td><input [(ngModel)]="song.track" required /></td>
          <td><input [(ngModel)]="song.albumArtist" required /></td>
          <td><input [(ngModel)]="song.composer" /></td>
          <td><input [(ngModel)]="song.discNumber" required /></td>
          <td>
            @if (song.cover.data && song.cover.format) {
              <img [src]="song.cover.data" height="50" width="50" />
            } @else {
              <img ngSrc="assets/images/placeholder.png" width="50" height="50" alt="Blah" (click)="toggleContextButtons()" />
              @if (showContextButtons) {
                <div class="context-btn-menu">
                  <button (click)="searchCover(song)">Search</button>
                  <button (click)="uploadCover(song)">Upload</button>
                  <button (click)="pasteCover(song)">Paste</button>
                </div>
              }
            }
          </td>
        </tr>
      }
    </tbody>
  </table>
</div>
